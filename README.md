![logo](doc/logo.png)

vanityURLs is a _simple_ solution to deploy a budget-friendly Url Shortener. It runs at scale in your Cloudflare subscription with continuous integration.

> If you don't own an a Cloudflare subscription already, you can create your free account today so you can experience everything without spending a dime.

Features:
 * Fully branded internet domain using Cloudflare [DNS](https://www.cloudflare.com/en-ca/application-services/products/dns/) & [Pages](https://pages.cloudflare.com/)
 * URL redirection (301, 302, 303, 307 and 308)
 * Advanced redirection with splats (e.g., /news/* --> /blog/:splat )
 * Continuous integration managed by Cloudflare Page Engine

My objective is to drive it at the command line and fully automate it. So feel free to fork, and customize.

## What problem does it solve and why is it useful?

You’ve been there too, a fully branded short URLs is useful but your low volume does not justify a commercial solution. Furthermore, links generated by a free solution will eventually expire and they're not privacy friendly.

## How does it work?

1. Register a __tiny__ internet domain name with your [preferred vendor](https://www.cloudflare.com/en-ca/products/registrar/)
2. Add the domain to [Cloudflare DNS](https://dash.cloudflare.com/)
3. Store your URLs redirection list in a __private__ GitHub repository
4. Create a project underneath Cloudflare Workers & Pages
    *  [Connect the repository](https://developers.cloudflare.com/pages/get-started/guide/#connect-your-git-provider-to-pages)
    * Configure your deployment and build setup:
      * Framework preset: none
      * Build command: none
      * Build output directory: /cfPage
    * Setup a [custom domain](https://developers.cloudflare.com/pages/platform/custom-domains/) for your page project
5. Configure the DNS entry via [Cloudflare DNS](https://dash.cloudflare.com/)

## How to use?

The code is tested on OS X Ventura and you need only Node.js in the system if you want to use [ Nano ID](https://github.com/ai/nanoid) to generate URL. You get unique ID in terminal by calling `npx nanoid`, you do not need Nano ID to be installed __anywhere__.

You can use `Make`:
  * url --> Generate a unique ID for a new URL
  * edit --> Modify the URLs redirection list
  * build --> GIT add & commit the updated URLs redirection list AND push to github

The secret sauce are two plain text files:
  * `cfPage/_redirects` based on this [documentation](https://developers.cloudflare.com/pages/platform/redirects)
  * `cfPage/_headers` based on this [documentation](https://developers.cloudflare.com/pages/platform/redirects)

According to

```bash
/mail https://outlook.office.com/ 301
/gmail https://gmail.com/ 302
/github https://github.com/bhdicaire/ 301
/github/* https://github.com/bhdicaire/:splat
```

### It's bullet proof

As long as you secure your Github and Cloudflare accounts with robust authentication, there is not much that can go wrong with such simple solution. It use the products as designed, there is no hack involved.


## Everything you always wanted to know about URL redirection (but were afraid to ask)

HTTP is a [protocol](https://developer.mozilla.org/en-US/docs/Web/HTTP/Resources_and_specifications) for fetching resources such as HTML documents. You can [redirect](https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections#Overview) at the service level, at the HTML page or via JavaScript if enabled.

The simplest way to redirect to another URL is to use an [HTML <meta>](https://www.w3docs.com/learn-html/html-meta-tag.html) tag with the http-equiv parameter set to “refresh”. The content attribute sets the delay before the browser redirects the user to the new web page. To redirect immediately, set this parameter to “0” seconds for the content attribute.

```html
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="refresh" content="0; url='https://github.com/bhdicaire'" />
  </head>
  <body>
    <p>You will be redirected to BH Dicaire's Github soon!</p>
  </body>
</html>
```

However HTTP redirects always execute first thus


## Licence
**vanityURLs** is [Copyright 2023 Benoît H. Dicaire and licensed under the MIT licence](https://github.com/bhdicaire/vanityURLs/blob/master/LICENCE).

An simple and easy Url Shortener driven by a CLI and hosted on Cloudflare
Shorten, personalize, and share fully branded short URLs with continuous integration on Cloudflare
